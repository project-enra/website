<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hook - Realm of the Codex | Project Enra</title>
    <meta name="description" content="Explore Hook, a Hampshire village shaped by the London to Southampton coaching route. Discover its history, heritage, and hidden Enwella through the Project Enra Codex.">
    <meta name="keywords" content="Hook Hampshire, Hook village history, Hook heritage, North Hampshire villages, Hampshire history">
    
    <!-- Open Graph tags -->
    <meta property="og:title" content="Hook: Tap to Reveal | Project Enra">
    <meta property="og:description" content="Tap here to reveal the fog and discover Hook's hidden heritage. A Hampshire village shaped by history, waiting to be uncovered.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://www.project-enra.com/codex/realms/hook/">
    <meta property="og:image" content="https://www.project-enra.com/codex/realms/hook/images/hook-share-card.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Tap to reveal Hook's hidden heritage">
    
    <!-- Twitter Card tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Hook: Tap to Reveal | Project Enra">
    <meta name="twitter:description" content="Tap here to reveal the fog and discover Hook's hidden heritage. A Hampshire village shaped by history, waiting to be uncovered.">
    <meta name="twitter:image" content="https://www.project-enra.com/codex/realms/hook/images/hook-share-card.png">
    <link rel="canonical" href="https://www.project-enra.com/codex/realms/hook/">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    
    <!-- Mapbox -->
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js"></script>
    
    <link rel="stylesheet" href="../../../styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English:ital,wght@0,400;1,400&family=Uncial+Antiqua&display=swap" rel="stylesheet">
    
    <!-- Analytics (GA4 + Clarity) -->
    <script src="/analytics.js"></script>
    
    <style>
        /* ============================================
           REALM PAGE - IMMERSIVE MAP EXPERIENCE
           ============================================ */
        
        body {
            overflow-x: hidden;
        }
        
        /* Fixed Map Background */
        #realm-map {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 0;
        }
        
        /* Fog Overlay - Clears on scroll */
        .fog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1;
            pointer-events: none;
            background: #0a0a0a;
            opacity: 1;
            transition: opacity 0.3s ease-out;
        }
        
        /* Scrolling Content Layer */
        .content-layer {
            position: relative;
            z-index: 10;
            min-height: 100vh;
        }
        
        /* Hero Section - Transparent to show map */
        .realm-hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            padding-top: 80px;
        }
        
        .realm-hero-content {
            max-width: 600px;
            padding: 3rem;
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(210, 129, 23, 0.3);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        .realm-badge {
            display: inline-block;
            background: linear-gradient(135deg, rgba(210, 129, 23, 0.25), rgba(45, 24, 16, 0.5));
            color: #E6941F;
            padding: 0.5rem 1.5rem;
            border-radius: 25px;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            border: 1px solid rgba(210, 129, 23, 0.4);
            margin-bottom: 1.5rem;
            text-shadow: 0 0 10px rgba(230, 148, 31, 0.5);
        }
        
        .realm-title {
            font-family: 'Uncial Antiqua', serif;
            font-size: 4rem;
            color: #E6941F;
            margin-bottom: 1rem;
            text-shadow: 
                0 0 30px rgba(210, 129, 23, 0.8),
                0 0 60px rgba(210, 129, 23, 0.4);
        }
        
        .realm-tagline {
            font-size: 1.3rem;
            color: #e8e3d3;
            font-style: italic;
            opacity: 0.9;
            margin-bottom: 2rem;
        }
        
        .scroll-prompt {
            color: rgba(232, 227, 211, 0.6);
            font-size: 0.9rem;
            animation: pulse 2s ease-in-out infinite;
        }
        
        .scroll-prompt span {
            display: block;
            margin-top: 0.5rem;
            font-size: 1.5rem;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        /* Content Cards */
        .content-section {
            max-width: 700px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .content-card {
            background: rgba(10, 10, 10, 0.88);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(210, 129, 23, 0.25);
            border-radius: 16px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 
                0 15px 50px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(210, 129, 23, 0.1);
            position: relative;
        }
        
        .content-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, rgba(210, 129, 23, 0.5), transparent);
            border-radius: 16px 16px 0 0;
        }
        
        .section-title {
            font-family: 'Uncial Antiqua', serif;
            font-size: 1.8rem;
            color: #E6941F;
            margin-bottom: 1.5rem;
            text-shadow: 0 0 15px rgba(230, 148, 31, 0.4);
        }
        
        .content-card p {
            color: #e8e3d3;
            font-size: 1.1rem;
            line-height: 1.9;
            margin-bottom: 1.2rem;
        }
        
        .content-card p:last-of-type {
            margin-bottom: 0;
        }
        
        /* Links in content */
        .content-card a {
            color: #E6941F;
            text-decoration: none;
            border-bottom: 1px solid rgba(230, 148, 31, 0.4);
            transition: border-color 0.2s ease;
        }
        
        .content-card a:hover {
            border-bottom-color: #E6941F;
        }
        
        /* Quick Stats Card */
        .stats-card {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }
        
        @media (min-width: 500px) {
            .stats-card {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        .stat-item {
            text-align: center;
            padding: 1rem 0.75rem;
            background: rgba(210, 129, 23, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(210, 129, 23, 0.15);
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 90px;
        }
        
        .stat-label {
            display: block;
            font-size: 0.7rem;
            color: rgba(232, 227, 211, 0.6);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            font-family: 'Uncial Antiqua', serif;
            font-size: 1rem;
            color: #E6941F;
            line-height: 1.3;
        }
        
        /* Historic Map Figures */
        .historic-map {
            margin: 1.5rem 0;
            padding: 0;
        }
        
        .historic-map img {
            width: 100%;
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            border: 1px solid rgba(210, 129, 23, 0.3);
            display: block;
            cursor: zoom-in;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .historic-map img:hover {
            box-shadow: 0 8px 30px rgba(210, 129, 23, 0.25);
        }
        
        .historic-map figcaption {
            margin-top: 0.75rem;
            font-size: 0.85rem;
            color: rgba(232, 227, 211, 0.7);
            font-style: italic;
            text-align: center;
            line-height: 1.5;
        }
        
        .historic-map figcaption .map-source {
            display: block;
            font-size: 0.75rem;
            color: rgba(232, 227, 211, 0.5);
            font-style: normal;
            margin-top: 0.25rem;
        }
        
        /* Lightbox overlay for enlarged maps */
        .lightbox-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            box-sizing: border-box;
            cursor: zoom-out;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .lightbox-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .lightbox-overlay img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        .lightbox-close {
            position: absolute;
            top: 1rem;
            right: 1.5rem;
            color: #e8e3d3;
            font-size: 2rem;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        
        .lightbox-close:hover {
            opacity: 1;
        }
        
        /* Sources */
        .sources-section {
            background: rgba(45, 24, 16, 0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1rem;
        }
        
        .sources-title {
            font-size: 0.9rem;
            color: #E6941F;
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .sources-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .sources-list li {
            font-size: 0.85rem;
            color: rgba(232, 227, 211, 0.6);
            margin-bottom: 0.4rem;
        }
        
        .sources-list a {
            color: rgba(232, 227, 211, 0.6);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .sources-list a:hover {
            color: #E6941F;
        }
        
        /* ============================================
           EXPLORE THE REALM - Full Map Section
           ============================================ */
        
        /* Trigger element - invisible, marks end of content */
        .map-trigger {
            height: 1px;
            width: 100%;
            pointer-events: none;
        }
        
        /* The explore section provides scroll anchor for map mode */
        .explore-section {
            position: relative;
            height: 100vh;
            pointer-events: none;
        }
        
        /* Fixed UI Panel - Contains header + enwella links */
        .explore-panel-fixed {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.6s ease;
        }
        
        .explore-panel-fixed.active {
            opacity: 1;
        }
        
        .explore-panel-fixed.active .explore-header {
            pointer-events: auto;
        }
        
        /* Top header bar */
        .explore-header {
            background: rgba(10, 10, 10, 0.94);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(210, 129, 23, 0.3);
            padding: 1rem 20px;
            margin-top: 80px; /* Account for main nav */
        }
        
        .explore-header-content {
            max-width: 1000px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1.5rem;
        }
        
        .explore-header-text {
            text-align: left;
        }
        
        .explore-title {
            font-family: 'Uncial Antiqua', serif;
            font-size: 1.5rem;
            color: #E6941F;
            margin-bottom: 0.25rem;
            text-shadow: 0 0 20px rgba(230, 148, 31, 0.5);
        }
        
        .explore-subtitle {
            color: #e8e3d3;
            font-size: 0.9rem;
            opacity: 0.85;
            margin: 0;
        }
        
        .explore-header-actions {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .explore-header-actions .cta-buttons {
            display: flex;
            gap: 0.75rem;
        }
        
        .explore-header-actions .cta-buttons .btn {
            padding: 0.5rem 1.25rem;
            font-size: 0.9rem;
        }
        
        /* Middle spacer - allows map interaction */
        .explore-spacer {
            flex: 1;
        }
        
        /* Back to reading button */
        .back-to-reading-btn {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: none; /* Hidden by default */
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1.25rem;
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(210, 129, 23, 0.4);
            border-radius: 25px;
            color: #e8e3d3;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1001;
            pointer-events: auto;
        }
        
        /* Show button when map is interactive */
        .map-interactive .back-to-reading-btn {
            display: flex;
        }
        
        .back-to-reading-btn:hover {
            background: rgba(210, 129, 23, 0.2);
            border-color: rgba(210, 129, 23, 0.6);
            color: #E6941F;
            transform: translateX(-50%) translateY(-2px);
        }
        
        .back-to-reading-btn span:first-child {
            font-size: 1.1rem;
        }
        
        /* When map is interactive */
        .map-interactive #realm-map {
            z-index: 15;
        }
        
        .map-interactive .fog-overlay {
            z-index: 14;
        }
        
        /* Smooth content fade when transitioning to map interactive */
        .content-layer {
            transition: opacity 0.6s ease;
        }
        
        .map-interactive .content-layer {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Keep main nav above everything */
        .map-interactive .header {
            z-index: 1001;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .explore-header {
                padding: 0.75rem 15px;
            }
            
            .explore-header-content {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
            }
            
            .explore-header-text {
                text-align: center;
            }
            
            .explore-title {
                font-size: 1.3rem;
            }
            
            .explore-header-actions {
                justify-content: center;
            }
            
            .explore-header-content {
                flex-direction: column;
                gap: 1rem;
            }
            
            /* Make back button more prominent on mobile */
            .back-to-reading-btn {
                bottom: 15px;
                padding: 0.75rem 1.5rem;
                font-size: 0.9rem;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            }
            
            .explore-header-text {
                text-align: center;
            }
            
            .explore-title {
                font-size: 1.3rem;
            }
            
            .explore-header-actions {
                flex-direction: column;
                width: 100%;
                text-align: center;
            }
            
            .explore-header-actions .cta-buttons {
                justify-content: center;
            }
        }
        
        /* Legacy explore-footer for SEO (hidden visually, in DOM for crawlers) */
        .explore-footer-seo {
            position: absolute;
            left: -9999px;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }
        
        
        /* Progress Indicator */
        .progress-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(210, 129, 23, 0.3);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            z-index: 100;
            text-align: center;
            transition: opacity 0.3s;
        }
        
        .progress-indicator.hidden,
        .map-interactive .progress-indicator {
            opacity: 0;
            pointer-events: none;
        }
        
        .progress-label {
            font-size: 0.7rem;
            color: rgba(232, 227, 211, 0.6);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }
        
        .progress-bar {
            width: 80px;
            height: 4px;
            background: rgba(210, 129, 23, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #D28117, #E6941F);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 2px;
        }
        
        /* Mapbox Popup Styling */
        .mapboxgl-popup-content {
            background: rgba(10, 10, 10, 0.95) !important;
            border: 1px solid rgba(210, 129, 23, 0.4) !important;
            border-radius: 12px !important;
            padding: 0 !important;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5) !important;
            min-width: 200px;
        }
        
        .mapboxgl-popup-tip {
            border-top-color: rgba(10, 10, 10, 0.95) !important;
        }
        
        .mapboxgl-popup-close-button {
            color: #E6941F !important;
            font-size: 1.2rem;
            padding: 5px 10px;
        }
        
        .enwella-popup {
            padding: 1rem;
        }
        
        .enwella-popup-type {
            font-size: 0.7rem;
            color: rgba(232, 227, 211, 0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.3rem;
        }
        
        .enwella-popup-name {
            font-family: 'Uncial Antiqua', serif;
            font-size: 1.2rem;
            color: #E6941F;
            margin-bottom: 0.75rem;
        }
        
        .enwella-popup-link {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #D28117, #E6941F);
            color: #0a0a0a;
            text-decoration: none;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .enwella-popup-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(210, 129, 23, 0.4);
        }
        
        /* Footer adjustments */
        .footer {
            position: relative;
            z-index: 10;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .realm-title {
                font-size: 2.8rem;
            }
            
            .realm-hero-content {
                padding: 2rem;
                margin: 0 1rem;
            }
            
            .content-card {
                padding: 1.75rem;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .realm-nav {
                flex-direction: column;
            }
            
            .progress-indicator {
                bottom: 10px;
                right: 10px;
                padding: 0.75rem 1rem;
            }
            
            .explore-title {
                font-size: 1.6rem;
            }
            
            .enwella-links {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Lightbox for enlarged maps -->
    <div class="lightbox-overlay" id="lightbox">
        <span class="lightbox-close">&times;</span>
        <img src="" alt="" id="lightbox-img">
    </div>

    <!-- Fixed Map Background -->
    <div id="realm-map"></div>
    
    <!-- Fog Overlay -->
    <div class="fog-overlay" id="fog"></div>
    
    <!-- Progress Indicator -->
    <div class="progress-indicator hidden" id="progress">
        <div class="progress-label">Realm Cleared</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>
    </div>
    
    <!-- Fixed Explore Panel (appears when map is interactive) -->
    <div class="explore-panel-fixed" id="explore-panel">
        <!-- Top Header -->
        <div class="explore-header">
            <div class="explore-header-content">
                <div class="explore-header-text">
                    <h2 class="explore-title">Explore the Realm</h2>
                    <p class="explore-subtitle">Pan the map and click the markers to discover the Enwella of Hook</p>
                </div>
                <div class="explore-header-actions">
                    <div class="cta-buttons">
                        <a href="/tools/route-planner" class="btn btn-secondary">Plan a Route</a>
                        <a href="/veilglass" class="btn btn-primary">Get Veilglass</a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Back to top button (mobile-friendly) -->
        <button class="back-to-reading-btn" id="back-to-reading-btn">
            <span>↑</span>
            <span>Back to top</span>
        </button>
        
        <!-- Middle spacer - map shows through here -->
        <div class="explore-spacer"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="nav-container">
                <div class="nav-logo">
                    <a href="/" style="display: flex; align-items: center; gap: 15px; text-decoration: none;">
                        <img src="../../../Images/penralogo.png" alt="Project Enra" class="logo-img">
                        <h1>Project Enra</h1>
                    </a>
                </div>
                <ul class="nav-menu">
                    <li><a href="/">Home</a></li>
                    <li><a href="/veilglass">Veilglass</a></li>
                    <li><a href="/codex/" class="active">Codex</a></li>
                    <li><a href="/tools">Tools</a></li>
                    <li><a href="/#contact">Contact</a></li>
                </ul>
                <div class="nav-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </nav>
    </header>

    <!-- Content Layer -->
    <div class="content-layer">
        <main>
            <!-- Hero -->
            <section class="realm-hero" id="hero">
                <div class="realm-hero-content">
                    <div class="realm-badge">Realm</div>
                    <h1 class="realm-title">Hook</h1>
                    <p class="realm-tagline">A coaching village on the road between worlds</p>
                    <div class="scroll-prompt">
                        Scroll to clear the fog
                        <span>↓</span>
                    </div>
                </div>
            </section>

            <!-- Article Content - All SEO-friendly, semantic HTML -->
            <article class="content-section">
                
                <!-- Quick Stats -->
                <div class="content-card" data-section="stats">
                    <div class="stats-card">
                        <div class="stat-item">
                            <span class="stat-label">Toponymy</span>
                            <span class="stat-value">Old English "hōc"</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">First Recorded</span>
                            <span class="stat-value">1223</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">County</span>
                            <span class="stat-value">Hampshire</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Historic Hundred</span>
                            <span class="stat-value">Odiham</span>
                        </div>
                    </div>
                </div>

                <!-- Origins -->
                <section class="content-card" data-section="origins" id="origins">
                    <h2 class="section-title">Origins</h2>
                    <p>
                        The name Hook derives from the Old English word <em>hōc</em>, meaning a hook, angle, 
                        or nook of land. The name was originally applied to woodland in this area, 
                        describing land shaped like a hook between two tributaries of the River Whitewater.
                        The earliest recorded spelling is <em>Hoc</em> in 1223.
                        (<a href="https://www.oldhampshiremapped.org.uk/hantsgaz/hantsgaz/s0003364.htm" target="_blank" rel="noopener">Old Hampshire Mapped</a>)
                    </p>
                    
                    <figure class="historic-map">
                        <img src="images/Taylors_Hampshire_1759_Hook.png" 
                             alt="Isaac Taylor's Map of Hampshire from 1759 showing Hook between Newnham and Odiham, with surrounding woodland and the main road" 
                             loading="lazy">
                        <figcaption>
                            Hook on Isaac Taylor's large-scale survey of Hampshire, 1759 — nestled between 
                            Newnham and Odiham, with the main London road running through.
                            <span class="map-source">Isaac Taylor, surveyor. Engraved by Richard Benning, 1759.</span>
                        </figcaption>
                    </figure>
                    
                    <p>
                        The earliest mention of Hook found in historical documents relates to a land dispute in 
                        the thirteenth century. For most of its history, Hook was not a distinct settlement but 
                        scattered farms and woodland within the neighbouring parishes of Odiham, Newnham, and 
                        Nately Scures. It was not until 1932 that Hook was formed into its own civil 
                        <a href="/codex/glossary/#parish">parish</a>, carved from parts of these three 
                        neighbours within the <a href="/codex/glossary/#hundred">hundred</a> of Odiham.
                        (<a href="https://hook.gov.uk/community-facilities/a-brief-history-of-hook" target="_blank" rel="noopener">Hook Parish Council</a>)
                    </p>
                </section>

                <!-- Through the Ages -->
                <section class="content-card" data-section="history" id="history">
                    <h2 class="section-title">Through the Ages</h2>
                    <p>
                        Hook's story is the story of a road. The route from London to the south-west of 
                        England — to Salisbury, Exeter, and ultimately Land's End — was one of the great 
                        arteries of Georgian Britain. Every day, <a href="/codex/glossary/#stagecoach-route">stagecoaches</a> 
                        thundered along this road carrying passengers, mail, and goods. And every few miles, 
                        they needed to stop: to change horses, to rest, to eat. Hook was one of those stops.
                    </p>
                    
                    <figure class="historic-map">
                        <img src="images/Senex_London_To_Lands_End_Hook_1757.jpg" 
                             alt="Senex strip map from 1757 showing The Road from London to Land's End, with Hook and Newnham marked on the route through Hampshire" 
                             loading="lazy">
                        <figcaption>
                            "The Road from London to the Lands-End in Cornwal. Actually Surveyed by a Wheel." 
                            Hook appears on this 1757 strip map, a vital stop on one of England's great coaching routes.
                            <span class="map-source">John Senex, 1757</span>
                        </figcaption>
                    </figure>
                    
                    <p>
                        By the 18th century, <a href="/codex/glossary/#coaching-inn">coaching inns</a> had 
                        appeared along the main street, offering fresh horses, food, and lodging to travellers 
                        making the long journey between capital and coast. In the late 18th century, a 
                        <a href="/codex/glossary/#turnpike-road">turnpike road</a> was constructed to aid 
                        navigation of the steep Scures Hill to the west — part of a network maintained by the 
                        Basingstoke, Odiham, and Alton Turnpike Trust, established in 1736. The road improved, 
                        the coaches grew faster, and Hook prospered.
                    </p>
                    <p>
                        The railway changed everything. In 1839, a line was built through Hook on its way 
                        from London to Basingstoke, but there was no station. Local landowners campaigned 
                        for one, seeking better transport for timber and crops. Their campaign succeeded: 
                        Hook railway station opened on 2 July 1883, signalling the birth of the modern village. 
                        The coaches fell silent, their inns repurposed, but Hook had already learned the art 
                        of serving travellers — a skill it would carry into the commuter age.
                    </p>
                    
                    <figure class="historic-map">
                        <img src="images/OS_1888-1915_Hook.png" 
                             alt="Ordnance Survey map of Hook from 1888-1915 showing the London and South Western Railway, Hook Station, the White Hart pub, and milestone marker" 
                             loading="lazy">
                        <figcaption>
                            Hook in the railway age. The Ordnance Survey shows the London & South Western Railway 
                            cutting through the village, with the station, the White Hart (P.H.), and a milestone 
                            marking "Basingstoke 6, Bagshot 13".
                            <span class="map-source">Ordnance Survey, c. 1888–1915. National Library of Scotland.</span>
                        </figcaption>
                    </figure>
                    <p>
                        Today, Hook sits between two worlds: close enough to London for commuters, 
                        rural enough to feel like Hampshire. The old coaching road is now the A30, 
                        but echoes of the past remain for those who know where to look.
                    </p>
                </section>

                <!-- The Realm Today -->
                <section class="content-card" data-section="today" id="today">
                    <h2 class="section-title">The Realm Today</h2>
                    <p>
                        Walk through Hook now and you'll find a village that has learned to balance 
                        heritage with growth. The high street still follows the old coaching route, 
                        lined with a mix of Victorian buildings and newer additions. The railway station 
                        remains the village's connection to the wider world.
                    </p>
                    <p>
                        Look closer and the layers reveal themselves: a historic coaching inn on London Road, 
                        St John the Evangelist — a parish church consecrated in 1938 and designed by 
                        Edward Maufe (architect of Guildford Cathedral) — and a war memorial that speaks 
                        of sacrifice in two world wars. These are the Enwella of Hook — places where 
                        history left its mark.
                    </p>
                    
                    <div class="sources-section">
                        <h4 class="sources-title">Sources</h4>
                        <ul class="sources-list">
                            <li><a href="https://hook.gov.uk/community-facilities/a-brief-history-of-hook" target="_blank" rel="noopener">Hook Parish Council: A Brief History of Hook</a></li>
                            <li><a href="https://www.oldhampshiremapped.org.uk/hantsgaz/hantsgaz/s0003364.htm" target="_blank" rel="noopener">Old Hampshire Mapped: Hook</a></li>
                            <li><a href="https://www.whitewaterchurches.co.uk/churches/st-johns-hook/about-st-johns/" target="_blank" rel="noopener">Whitewater Churches: St John's Hook</a></li>
                            <li><a href="https://en.wikipedia.org/wiki/Hook_railway_station" target="_blank" rel="noopener">Wikipedia: Hook Railway Station</a></li>
                        </ul>
                    </div>
                </section>

                <!-- Map trigger - when this enters viewport, map mode activates -->
                <div class="map-trigger" id="map-trigger"></div>

            </article>

            <!-- Hidden SEO section for crawlers (visually hidden but in DOM) -->
            <section class="explore-footer-seo" aria-label="Enwella locations in Hook">
                <h3>Enwella in this Realm</h3>
                <ul>
                    <li><a href="/codex/realms/hook/enwella/white-hart/">The White Hart - Coaching Inn</a></li>
                    <li><a href="/codex/realms/hook/enwella/hook-station/">Hook Railway Station</a></li>
                    <li><a href="/codex/realms/hook/enwella/bartley-heath/">Bartley Heath - Nature Reserve</a></li>
                    <li><a href="/codex/realms/hook/enwella/bassetts-mead/">Bassetts Mead - Country Park</a></li>
                    <li><a href="/codex/realms/hook/enwella/whitewater-meadows/">Whitewater Meadows</a></li>
                    <li><a href="/codex/realms/hook/enwella/crooked-billet/">The Crooked Billet - Pub</a></li>
                    <li><a href="/codex/realms/hook/enwella/old-raven-house/">Old Raven House - Historic Building</a></li>
                    <li><a href="/codex/realms/hook/enwella/raven-hotel/">The Raven Hotel</a></li>
                    <li><a href="/codex/realms/hook/enwella/old-white-hart/">The Old White Hart - Pub</a></li>
                    <li><a href="/codex/realms/hook/enwella/st-johns-church/">St John the Evangelist Church</a></li>
                </ul>
            </section>

            <!-- Explore section - provides scroll space for map mode -->
            <section class="explore-section" id="explore"></section>

        </main>

        <footer class="footer">
            <div class="container">
                <div class="footer-content">
                    <div class="footer-section">
                        <h3>Project Enra</h3>
                        <p>Creating tools and content for heritage discovery.</p>
                    </div>
                    <div class="footer-section">
                        <h3>Explore</h3>
                        <ul>
                            <li><a href="/">Home</a></li>
                            <li><a href="/veilglass">Veilglass</a></li>
                            <li><a href="/codex/">Codex</a></li>
                            <li><a href="/tools">Tools</a></li>
                        </ul>
                    </div>
                    <div class="footer-section">
                        <h3>Legal</h3>
                        <ul>
                            <li><a href="/privacy-policy">Privacy Policy</a></li>
                            <li><a href="/terms-of-service">Terms of Service</a></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-bottom">
                    <div class="footer-bottom-content">
                        <p>&copy; 2026 Project Enra. All rights reserved.</p>
                        <div class="project-enra-credit">
                            <img src="../../../Images/Moss-Covered Stone with Glowing Cracks.png" alt="Project Enra" class="enra-logo">
                            <span>Project Enra</span>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // ============================================
        // MAPBOX SETUP
        // ============================================
        
        mapboxgl.accessToken = 'pk.eyJ1Ijoic2xpa3Jpazg5IiwiYSI6ImNtOWo2OHFlaDA5aWcyanNiY2RkMndqOTMifQ.2grzIG93bbdQ8wmJV2KK6w';
        
        // Initialize map centered on Hook
        const map = new mapboxgl.Map({
            container: 'realm-map',
            style: 'mapbox://styles/mapbox/dark-v11',
            center: [-0.9635, 51.2840],
            zoom: 14,
            interactive: false, // Start non-interactive
            attributionControl: false
        });

        map.addControl(new mapboxgl.AttributionControl({
            compact: true
        }), 'bottom-left');

        // ============================================
        // ENWELLA MARKERS WITH POPUPS
        // ============================================
        
        const enwellaLocations = [
            { 
                name: 'The White Hart', 
                type: 'Coaching Inn', 
                coords: [-0.9617744914670631, 51.283141320663056], 
                link: 'enwella/white-hart/',
                description: 'Historic 16th-century coaching inn'
            },
            { 
                name: 'Hook Railway Station', 
                type: 'Station', 
                coords: [-0.9615980727290431, 51.28008308516285], 
                link: 'enwella/hook-station/',
                description: 'Opened 1883, birth of modern Hook'
            },
            { 
                name: 'Bartley Heath', 
                type: 'Nature', 
                coords: [-0.9556347991281431, 51.275390096815755], 
                link: 'enwella/bartley-heath/',
                description: 'SSSI heathland and woodland'
            },
            { 
                name: 'Bassetts Mead', 
                type: 'Park', 
                coords: [-0.9446003537409877, 51.286353507375644], 
                link: 'enwella/bassetts-mead/',
                description: 'Country park with meadows and lake'
            },
            { 
                name: 'Whitewater Meadows', 
                type: 'Nature', 
                coords: [-0.9478239872847778, 51.28955662838724], 
                link: 'enwella/whitewater-meadows/',
                description: 'River, mill site, and chalk stream wildlife'
            },
            { 
                name: 'The Crooked Billet', 
                type: 'Pub', 
                coords: [-0.9445099716647039, 51.28811525162456], 
                link: 'enwella/crooked-billet/',
                description: '18th-century riverside pub'
            },
            { 
                name: 'Old Raven House', 
                type: 'Historic', 
                coords: [-0.9557474977796759, 51.28700357063947], 
                link: 'enwella/old-raven-house/',
                description: '1653 timber-framed coaching inn'
            },
            { 
                name: 'The Raven Hotel', 
                type: 'Hotel', 
                coords: [-0.9616976623366318, 51.281143248178864], 
                link: 'enwella/raven-hotel/',
                description: '1901 manor house, now hotel'
            },
            { 
                name: 'The Old White Hart', 
                type: 'Pub', 
                coords: [-0.9638446609930937, 51.282272249569566], 
                link: 'enwella/old-white-hart/',
                description: 'Traditional community pub'
            },
            { 
                name: 'St John the Evangelist', 
                type: 'Church', 
                coords: [-0.9602696174200069, 51.28348740052563], 
                link: 'enwella/st-johns-church/',
                description: '1938 church by Edward Maufe'
            }
        ];

        const markers = [];
        let currentOpenPopup = null; // Track the currently open popup

        enwellaLocations.forEach(loc => {
            // Create marker element
            const el = document.createElement('div');
            el.className = 'enwella-marker';
            el.style.cssText = `
                width: 28px;
                height: 28px;
                background: #E6941F;
                border: 3px solid #0a0a0a;
                border-radius: 50%;
                box-shadow: 0 0 20px rgba(230, 148, 31, 0.7);
                cursor: pointer;
                opacity: 0;
                transition: opacity 0.5s ease, box-shadow 0.3s ease;
            `;
            
            el.addEventListener('mouseenter', () => {
                el.style.boxShadow = '0 0 30px rgba(230, 148, 31, 1), 0 0 50px rgba(230, 148, 31, 0.5)';
                el.style.background = '#F4A73B';
            });
            el.addEventListener('mouseleave', () => {
                el.style.boxShadow = '0 0 20px rgba(230, 148, 31, 0.7)';
                el.style.background = '#E6941F';
            });

            // Create popup
            const popup = new mapboxgl.Popup({ 
                offset: 25,
                closeButton: true,
                closeOnClick: false
            }).setHTML(`
                <div class="enwella-popup">
                    <div class="enwella-popup-type">${loc.type}</div>
                    <div class="enwella-popup-name">${loc.name}</div>
                    <a href="${loc.link}" class="enwella-popup-link">Explore →</a>
                </div>
            `);

            const marker = new mapboxgl.Marker(el)
                .setLngLat(loc.coords)
                .setPopup(popup)
                .addTo(map);
            
            // Add click handler to close other popups when this one opens
            el.addEventListener('click', () => {
                // Close any currently open popup
                if (currentOpenPopup && currentOpenPopup !== popup) {
                    currentOpenPopup.remove();
                }
                // Track this as the current open popup
                currentOpenPopup = popup;
                
                // When this popup closes, clear the tracking
                popup.on('close', () => {
                    if (currentOpenPopup === popup) {
                        currentOpenPopup = null;
                    }
                });
            });
            
            markers.push({ marker, element: el, popup });
        });

        // ============================================
        // SCROLL-DRIVEN FOG CLEARING + MAP INTERACTIVITY
        // ============================================
        
        const fog = document.getElementById('fog');
        const progress = document.getElementById('progress');
        const progressFill = document.getElementById('progress-fill');
        const explorePanel = document.getElementById('explore-panel');
        const mapTrigger = document.getElementById('map-trigger');
        let mapInteractive = false;
        let navControlAdded = false;
        
        // Get the content section for calculating fog progress
        const contentSection = document.querySelector('.content-section');
        
        function getContentScrollProgress() {
            if (!contentSection) return 0;
            
            const contentRect = contentSection.getBoundingClientRect();
            const contentTop = contentSection.offsetTop;
            const contentHeight = contentSection.offsetHeight;
            const scrollTop = window.scrollY;
            const viewportHeight = window.innerHeight;
            
            // Progress through content: 0 = at top, 1 = content fully scrolled past
            const scrolledIntoContent = scrollTop - contentTop + viewportHeight;
            const progress = Math.max(0, Math.min(1, scrolledIntoContent / (contentHeight + viewportHeight)));
            
            return progress;
        }
        
        function updateFogAndMarkers() {
            const scrollProgress = getContentScrollProgress();
            
            // Show/hide progress indicator based on content progress
            if (scrollProgress > 0.1 && scrollProgress < 0.95) {
                progress.classList.remove('hidden');
            } else {
                progress.classList.add('hidden');
            }
            
            // Update progress bar
            progressFill.style.width = `${Math.min(scrollProgress * 100, 100)}%`;
            
            // Smooth fog clearing based on content scroll
            // Fog starts clearing at 10% into content, fully clear at 70%
            const fogProgress = Math.max(0, (scrollProgress - 0.1) / 0.6);
            const fogOpacity = Math.max(0, 1 - fogProgress);
            fog.style.opacity = fogOpacity;
            
            // Show markers progressively as fog clears
            markers.forEach((m, index) => {
                // Stagger marker appearance based on fog clearing
                const markerThreshold = 0.4 + (index * 0.04);
                const markerOpacity = Math.min(1, Math.max(0, (scrollProgress - markerThreshold) / 0.15));
                m.element.style.opacity = markerOpacity;
            });
        }
        
        function activateMapMode() {
            if (mapInteractive) return;
            
            mapInteractive = true;
            document.body.classList.add('map-interactive');
            explorePanel.classList.add('active');
            
            // Enable map controls
            map.dragPan.enable();
            map.doubleClickZoom.enable();
            map.touchZoomRotate.enable();
            
            // Add zoom controls once
            if (!navControlAdded) {
                map.addControl(new mapboxgl.NavigationControl({ showCompass: false }), 'top-right');
                navControlAdded = true;
            }
            
            // Ensure all markers are visible
            markers.forEach(m => {
                m.element.style.opacity = 1;
            });
            
            // Ensure fog is cleared
            fog.style.opacity = 0;
        }
        
        function deactivateMapMode() {
            if (!mapInteractive) return;
            
            mapInteractive = false;
            document.body.classList.remove('map-interactive');
            explorePanel.classList.remove('active');
            
            // Disable map controls
            map.dragPan.disable();
            map.doubleClickZoom.disable();
            map.touchZoomRotate.disable();
        }
        
        // IntersectionObserver to detect when content ends
        // Use a second observer to detect when we've scrolled back to content
        const contentCards = document.querySelectorAll('.content-card');
        const lastContentCard = contentCards[contentCards.length - 1];
        
        // Activate map when trigger enters viewport
        const mapTriggerObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    activateMapMode();
                }
            });
        }, {
            threshold: 0,
            rootMargin: '0px 0px -30% 0px' // Activate when trigger is in top 70% of viewport
        });
        
        mapTriggerObserver.observe(mapTrigger);
        
        // Deactivate map when last content card comes back into view (scrolling up)
        const contentObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && mapInteractive) {
                    // Last content card is visible again - user scrolled back up
                    deactivateMapMode();
                }
            });
        }, {
            threshold: 0.3 // Deactivate when 30% of last card is visible
        });
        
        contentObserver.observe(lastContentCard);
        
        // Back to reading button - scroll to top and deactivate map mode
        const backToReadingBtn = document.getElementById('back-to-reading-btn');
        backToReadingBtn.addEventListener('click', () => {
            deactivateMapMode();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        
        // Throttled scroll handler for fog/marker updates
        let ticking = false;
        window.addEventListener('scroll', () => {
            if (!ticking) {
                requestAnimationFrame(() => {
                    updateFogAndMarkers();
                    ticking = false;
                });
                ticking = true;
            }
        });
        
        // Initial state
        updateFogAndMarkers();

        // ============================================
        // MOBILE MENU
        // ============================================
        
        document.addEventListener('DOMContentLoaded', function() {
            const navToggle = document.querySelector('.nav-toggle');
            const navMenu = document.querySelector('.nav-menu');
            
            if (navToggle && navMenu) {
                navToggle.addEventListener('click', function() {
                    navMenu.classList.toggle('active');
                    navToggle.classList.toggle('active');
                });
            }
            
            // ============================================
            // LIGHTBOX FOR HISTORIC MAPS
            // ============================================
            
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = document.getElementById('lightbox-img');
            const lightboxClose = document.querySelector('.lightbox-close');
            const historicMapImages = document.querySelectorAll('.historic-map img');
            
            historicMapImages.forEach(img => {
                img.addEventListener('click', function() {
                    lightboxImg.src = this.src;
                    lightboxImg.alt = this.alt;
                    lightbox.classList.add('active');
                    document.body.style.overflow = 'hidden';
                });
            });
            
            function closeLightbox() {
                lightbox.classList.remove('active');
                document.body.style.overflow = '';
            }
            
            lightbox.addEventListener('click', closeLightbox);
            lightboxClose.addEventListener('click', closeLightbox);
            
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && lightbox.classList.contains('active')) {
                    closeLightbox();
                }
            });
        });
    </script>
</body>
</html>
